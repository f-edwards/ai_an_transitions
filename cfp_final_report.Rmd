---
title: "Mechanisms of AIAN Inequality in Child Welfare Across U.S. States."
author: "Frank Edwards and Theresa Rocha Beardall"
date: "12/2020"
abstract: "American Indian and Alaska Native children are separated from their families by state child welfare agencies at exceptionally high rates. This study connects contemporary trends in Native family separation to histories of Indian child removal, and locates places and institutional sites where inequality emerges."
output: bookdown::pdf_document2
---

```{r setup, include=FALSE}
### load packages and suppress warnings
knitr::opts_chunk$set(echo = F, message = F, warning = F)
library(tidyverse, warn.conflicts = FALSE)
options(dplyr.summarise.inform = FALSE)

library(bookdown)
library(geofacet)
library(RColorBrewer)
library(mapproj)
library(usmap)
library(gridExtra)
theme_set(theme_bw())

```

```{r read-make}
#### make data for easy load
# source("make_state_tables.R")
# source("make_national_tables.r")
# source("read_adopt.r")
# 
# save.image("./cfp_final_report.RData")

load("./cfp_final_report.RData")
```

# Introduction

clear statement on ongoing crisis of native family separation. aim of report is to 1) evaluate magnitude of change since ICWA, 2) ID geographic variation in inequality, 3) ID sites and places where inequality is accelerated

# lit review

1. historical importance of family separation
2. ICWA and policy
3. prior empirics on AIAN inequality

# Data

1. AAIA data

As landmark data. Explain methods. Explain strengths, explain limitations. states included and selction criteria

2. NCANDS
3. AFCARS FC
4. AFCARS Adoption
5. Population data

# Methods

0. age distribution from SEER onto pep
1. point-in-time comps

AAIA compiled point-in-time estimates of the numbers of AIAN children 21 years of age and under in adoption or foster care in each state for which they were able to collect complete data through surveys of state agencies and private providers. We compare these numbers to counts of children in foster care at year-end and to total numbers of children in state-sponsored adoptions. Annual foster care counts are straightforward to compute with AFCARS, by restricting caseload counts to 


EXPLAIN VARIABLE YEAR OF DATA COLLECTION FOR AAIA

2. period lifetables (age-spec / lifetime)
3. conditional probs
4. imputation

# Findings 

## Change since ICWA

```{r icwa-setup}
####################################################################################
############## ICWA figures
####################################################################################

### ICWA AAIA data STATES

icwa_fc<-icwa_fc %>% 
  filter(!is.na(fc))


### ICWA DATA NAT

icwa_nat<-icwa %>% 
  filter(!(is.na(fc_aian))) %>% 
  summarize(fc_aian = sum(fc_aian),
            fc_non = sum(fc_non),
            pop_aian21 = sum(pop_aian21),
            pop_non = sum(pop_nonAIAN21))

icwa_st<-icwa %>% 
  filter(!(is.na(fc_aian))) 

## 


afcars_caseload19<-read_csv("./data/afcars19_caseload.csv")
afcars_caseload19<-afcars_caseload19 %>% 
  mutate(race_ethn = ifelse(AMIAKN==1,
                            "AIAN",
                            "other")) %>% 
  rename(state = St,
         st_fips = STATE,
         fc = caseload) %>% 
  filter(st_fips!=72) %>% 
  select(st_fips, race_ethn, fc) %>% 
  filter(!is.na(race_ethn))

# afcars_caseload<-read_csv("./data/state_first_fc.csv")%>%
#   filter(.imp==1) %>% 
#   rename(year = fy) %>%
#   filter(state!=72) %>%
#   rename(var = first_entry) %>%
#   rename(st_fips = state) %>% 
#   filter(year == 2018) %>% 
#   mutate(race_ethn = ifelse(race_ethn=="AI/AN",
#                             "AIAN",
#                             "other")) %>% 
#   group_by(st_fips, race_ethn) %>% 
#   summarise(fc = sum(var)) %>% 
#   ungroup() %>% 
#   left_join(pop_seer_nat %>% 
#               filter(age<=21) %>% 
#               select(state, st_fips, age, race_ethn, pop) %>% 
#               group_by(state, st_fips, race_ethn) %>% 
#               summarize(pop = sum(pop)) %>% 
#               ungroup()) %>% 
#   filter(state%in%icwa_fc$state) %>% 
#   ungroup()

### add adoption data

### join with afcars adoption data
afcars_caseload<-afcars_caseload19 %>% 
  left_join(afcars_adopt_caseload_19 %>% 
  mutate(race_ethn = ifelse(race_ethn=="AIAN", 
                            race_ethn,
                            "other")) %>% 
  mutate(n_non_preferred = ifelse(race_ethn=="AIAN",
                                  n - n_kin_or_aian,
                                  n - n_kin),
         adopt_non_preferred = n_non_preferred / n) %>% 
    rename(st_fips = STATE,
           state = St,
           adopted = n) %>% 
  select(state, race_ethn, adopted, adopt_non_preferred)) %>% 
  mutate(state,  race_ethn, fc, adopted) %>% 
  mutate(period = "2019")

### state comparisons
icwa_delta<-icwa_fc %>% 
  select(-St) %>% 
  mutate(race_ethn = ifelse(race_ethn=="White",
                            "other",
                            race_ethn)) %>% 
  bind_rows(afcars_caseload %>% 
              select(state, period, race_ethn, fc, adopted)) %>% 
  filter(state%in%icwa_fc$state)

### make comparable national totals
### can't compare per cap rates
### pop denominators aren't comparable

icwa_delta_pct<-
  icwa_delta %>% 
  pivot_wider(id_cols = c(state, race_ethn),
              names_from = period, 
              values_from = c(fc, adopted)) %>% 
  mutate(delta_fc = (fc_2019 / fc_1976 -1) * 100,
         delta_adopt = (adopted_2019/adopted_1976 -1)*100) %>% 
  select(state, race_ethn, delta_fc, delta_adopt) %>% 
  pivot_longer(cols = delta_fc:delta_adopt) %>% 
  mutate(name = ifelse(
    name=="delta_fc",
    "Foster care",
    "Adoption"
  ))

### remove adoption states where we don't have AIAN ICWA numbers
index<-icwa_delta_pct %>% 
  filter(is.na(value))

icwa_delta_pct <- icwa_delta_pct %>% 
  mutate(value = ifelse(state%in%index$state & name == "Adoption",
         NA,
         value))


icwa_nat<-icwa_delta %>% 
  filter(!state%in%index$state) %>% 
  group_by(period, race_ethn) %>% 
  summarise(fc = sum(fc),
            adopted = sum(adopted))


### plus boarding
total_inst<-icwa_delta %>% 
  group_by(period, race_ethn) %>% 
  summarise(fc = sum(fc),
            adopted = sum(adopted, na.rm=T)) %>% 
  mutate(total = fc + adopted)

icwa_nat_na<-icwa_delta %>% 
  group_by(period, race_ethn) %>% 
  summarise(fc = sum(fc, na.rm=T),
            adopted = sum(adopted, na.rm=T))
```

We compare data collected by the Association on American Indian Affairs between 1973 and 1976 on American Indian and Alaska Native children in foster care and adoption to contemporary data on AIAN children in foster care and adoption collected through the Adoption and Foster Care Analysis and Reporting System between 2010 and 2019. Figure \@ref(fig:icwa-fc-counts) shows the total numbers of children in foster care as reported by AAIA in the mid-1970s and in AFCARS in 2019. There were `r icwa_nat_na$fc[1]` Native children in the 19 states for which AAIA collected data in the mid-1970s. In 2019, there were `r icwa_nat_na$fc[3]` Native children in foster care, an increase of `r round(((icwa_nat_na$fc[3] / icwa_nat_na$fc[1]) - 1) * 100,1)` AIAN children in foster care over this period. For non-Native children in these 19 states, caseloads increased by `r round(((icwa_nat_na$fc[4] / icwa_nat_na$fc[2]) - 1) * 100,1)` percent over the same period. 

```{r icwa-fc-counts, fig.cap = "Children in foster care on reporting date (caseload) by state and period. Data from AAIA surveys and AFCARS"}
ggplot(icwa_delta %>% 
         mutate(race_ethn = 
                  ifelse(race_ethn=="other",
                         "Non-AIAN",
                         race_ethn)),
       aes(y = state, x = fc, fill = period)) + 
  geom_col(position = position_dodge2(reverse = T)) + 
  facet_wrap(~race_ethn, scales = "free") + 
  scale_fill_brewer(palette = "Dark2") + 
  labs(y = "",
       x = "Children in foster care",
       fill = "") 
```

Figure \@ref(fig:icwa-adopt-counts) displays counts of children 21 years of age or younger in state-involved adoptions for both the mid-1970s and 2019. Note that 6 of the 19 included states lack complete data on AIAN children in adoption in the AAIA data (Idaho, Maine, Nevada, New Mexico, New York, and Wyoming). For these 13 states with complete adoption data, AAIA estimated that there were `r icwa_nat$adopted[1]` Native children in state-involved adoptions in the mid-1970s. In these same 13 states, there were `r icwa_nat$adopted[3]` AIAN children in adoptions in 2019, an increase of `r round(((icwa_nat_na$adopted[3] / icwa_nat_na$adopted[1]) - 1) * 100,1)` percent. For non-native children in these states, there was a `r round(abs(((icwa_nat_na$adopted[2] / icwa_nat_na$adopted[4]) - 1) * 100),1)` percent reduction in the numbers of adopted children over the same period.

`r round(((icwa_nat_na$fc[3] / icwa_nat_na$fc[1]) - 1) * 100,1)`

```{r icwa-adopt-counts, fig.cap = "Children 21 and under in state-involved adoptions on reporting date by state and period. Data from AAIA surveys and AFCARS"}
  ggplot(icwa_delta %>% 
           mutate(race_ethn = 
                    ifelse(race_ethn=="other",
                           "Non-AIAN",
                           race_ethn)),
         aes(y = state, x = adopted, fill = period)) + 
    geom_col(position = position_dodge2(reverse = T)) + 
    facet_wrap(~race_ethn, scales = "free") + 
    scale_fill_brewer(palette = "Dark2") + 
    labs(y = "",
         x = "Children in adoption",
         fill = "") 

#### make state-level proportional change over time 
### for both outcomes
```

Figure \@ref(fig:icwa-pct) shows the relative change in adoptive and foster care caseloads between the mid-1970s and 2019 for these large Native population states. Of the 19 states with complete data, 14 saw growth in the numbers of Native children in foster care since the passage of ICWA. Of the 13 states with complete adoption data, 8 had more Native children in foster care in 2019 than in the mid-1970s prior to the passage of ICWA. For non-Native children, foster care caseloads were higher in 16 of 19 states and adoption caseloads were higher in 6 of the 13 states with complete data. Oklahoma saw the largest absolute growth in Native foster care caseloads. In the mid-1970s, there were `r icwa_delta %>% filter(state=="OK", race_ethn=="AIAN", period == 1976) %>% select(fc) ` Native chlidren in foster care in Oklahoma. In 2019, here were `r icwa_delta %>% filter(state=="OK", race_ethn=="AIAN", period == 2019) %>% select(fc) ` Native children in foster care in Oklahoma, a growth of nearly `r round(icwa_delta_pct %>% filter(state=="OK", name == "Foster care", race_ethn == "AIAN") %>% select(value), 0)` percent.

```{r icwa-pct, fig.cap = "Percent change in adoption and foster care caseloads between 1976 and 2019. Data from AAIA surveys and AFCARS"}

ggplot(icwa_delta_pct %>% 
         mutate(race_ethn =
                  ifelse(race_ethn == "AIAN",
                         race_ethn,
                         "Non-AIAN")),
       aes(x = value,
           y = state,
           fill = name)) + 
  geom_col(position = position_dodge2(reverse = T)) + 
  labs(y = "") +
  geom_vline(xintercept = 0, lty = 2) +
  scale_fill_brewer(palette = "Dark2") + 
  facet_wrap(~race_ethn, scales = "free") + 
  labs(fill = "", 
       x = "Percent increase, 1976 to 2019")
  

```

```{r}
#COMPUTE GROWTH IN AIAN - GROWTH IN NONAIAN FOR WHICH GREW FASTER.
icwa_delta_aian<-icwa_delta_pct %>% 
  filter(race_ethn=="AIAN") %>% 
  select(-race_ethn) %>% 
  rename(aian_value = value)
icwa_delta_non<-icwa_delta_pct %>% 
  filter(race_ethn!="AIAN") %>% 
  select(-race_ethn) %>% 
  rename(non_aian_value = value)

icwa_pct_diff<-icwa_delta_aian %>% 
  left_join(icwa_delta_non) %>% 
  mutate(diff = aian_value - non_aian_value)

tab_higher<-icwa_pct_diff %>% 
  group_by(name) %>% 
  summarise(aian_higher = sum(diff>0, na.rm=T))
```

Foster care caseloads grew in many states for both non-AIAN and AIAN children. Of the 19 states included here, 12 saw higher growth in AIAN foster care caseloads than they saw in non-AIAN fooster care caseloads. Adoption caseloads also grew faster for AIAN children in these states than they did for non-AIAN children. In 7 of 13 states with complete data, AIAN adoption caseloads grew faster between the mid-1970s and 2019 than did non-AIAN adoption caseloads. 

Of course, these data do not provide a complete comparative picture of Indian family separation over time. Until the late 20th century, American Indian and Alaska Native children were routinely removed from their families and sent to residential boarding schools. Approximately 25000 Native children were in Bureau of Indian Affairs boarding schools in 1973. This total is larger than the total number of Native children in foster care or adoption recorded by AAIA in 1976. There were more AIAN children in boarding schools in 1973 than were in foster care in 2019. While the scale of separation of Native children from their families through foster care and adoption has increased over time in these states, the absolute scale of the separation of Native children from their families has likely declined nationally with the end of the boarding school era.

# National and state-level marginal probabilities

pull from data leaders slides

# Conditional probabilities

pull from data leaders slides

# Discussion

# Conclusion